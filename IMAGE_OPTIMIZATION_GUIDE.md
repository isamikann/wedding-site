# 画像最適化ガイド 🖼️

現在、写真ファイルが非常に大きく（5-7MB/枚）、読み込みが遅くなっています。
このガイドに従って画像を最適化することをお勧めします。

## 📊 現在の状況

```
prewedding/photo1.jpg: 5.9MB  ⚠️ 大きすぎます
prewedding/photo2.jpeg: 7.3MB ⚠️ 大きすぎます
prewedding/photo3.jpeg: 6.4MB ⚠️ 大きすぎます
memories/photo1.jpg: 0.7MB    ✓ OK
```

**推奨サイズ: 200-500KB/枚**

## 🚀 方法1: 自動スクリプト（推奨）

### 必要なツール
ImageMagickをインストール:

```bash
# Ubuntu/Debian
sudo apt install imagemagick

# macOS
brew install imagemagick
```

### 実行方法

```bash
# 写真フォルダ全体を最適化
./optimize-images.sh

# 特定のフォルダのみ最適化
./optimize-images.sh img/photos/prewedding
```

スクリプトは自動的に:
- 元の画像をバックアップ
- 1500x1500px以下にリサイズ
- 品質85%で圧縮
- 削減量を表示

## 🖱️ 方法2: オンラインツール（簡単）

### TinyPNG（おすすめ）
https://tinypng.com/

1. 写真をアップロード（最大20枚まで）
2. 自動で圧縮される
3. ダウンロードして元のファイルと置き換え

**特徴:**
- 簡単で高品質
- 無料（20枚/回まで）
- ファイルサイズを70-80%削減

### Squoosh（詳細設定可能）
https://squoosh.app/

1. 画像をドラッグ&ドロップ
2. 品質スライダーで調整（85推奨）
3. ダウンロード

**特徴:**
- Googleの公式ツール
- リアルタイムプレビュー
- WebP形式にも変換可能

## 💻 方法3: コマンドライン

### 1枚ずつ最適化

```bash
convert input.jpg -resize 1500x1500\> -quality 85 output.jpg
```

### バッチ処理

```bash
cd img/photos/prewedding

# すべてのJPGを最適化
for file in *.jpg *.jpeg; do
  convert "$file" -resize 1500x1500\> -quality 85 -strip "optimized_$file"
done

# 確認後、置き換え
rm *.jpg *.jpeg
rename 's/optimized_//' optimized_*
```

## 🎯 最適化の目標値

| 項目 | 現在 | 目標 |
|------|------|------|
| ファイルサイズ | 5-7MB | 200-500KB |
| 幅 | 3000-5000px | 1500-2000px |
| 読み込み時間 | 遅い | 高速 |
| 品質 | 最高 | 高品質（85%） |

## ✅ 最適化後の確認

1. ブラウザで開く
2. DevToolsを開く（F12）
3. Networkタブで読み込みサイズを確認
4. 画像品質を目視確認

## 📝 品質のガイドライン

- **品質90-100%**: ほぼ無損失、ファイルサイズ大
- **品質85%**: 最適なバランス ← **推奨**
- **品質80%**: より小さく、品質差は少ない
- **品質70%以下**: 圧縮アーティファクトが目立つ

## 🔄 WebP形式への変換（オプション）

さらなる高速化が必要な場合:

```bash
# cwebpをインストール
sudo apt install webp

# 変換
cwebp -q 85 input.jpg -o output.webp
```

WebPは同じ品質でJPEGより30-50%小さくなります。

ただし、古いブラウザでは非対応のため、フォールバック設定が必要です。

## 💡 ヒント

### 最適化する前に
- ✅ バックアップを作成
- ✅ 数枚でテストしてから一括処理
- ✅ 元の画質と比較

### 最適化した後
- ✅ ブラウザのキャッシュをクリア（Ctrl+Shift+R）
- ✅ 画質を確認
- ✅ 読み込み速度をテスト

### スマホから転送した写真の場合
- 最近のスマホは高解像度（12MP以上）
- ウェブ表示には過剰なサイズ
- 必ず最適化を推奨

## 🚫 よくある間違い

❌ 品質を低くしすぎる（60%以下）
→ 画質が大きく劣化

❌ リサイズせずに圧縮だけ
→ ファイルサイズがあまり減らない

❌ オリジナルを削除してしまう
→ バックアップは必須

## 🆘 トラブルシューティング

### Q: 最適化したのにまだ遅い
A: ブラウザのキャッシュをクリアしましたか？

### Q: 画質が悪くなった
A: 品質を85-90%に上げてみてください

### Q: ImageMagickがインストールできない
A: オンラインツール（TinyPNG）を使用してください

### Q: 間違って圧縮しすぎた
A: バックアップから復元してください

## 📞 サポート

質問がある場合は、`PERFORMANCE_IMPROVEMENTS.md` も参照してください。
